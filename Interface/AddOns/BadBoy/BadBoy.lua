
if WOW_PROJECT_ID ~= WOW_PROJECT_CLASSIC then
	print("|cFF33FF99BadBoy|r: You're trying to run the Classic version of BadBoy on a live server.")
	return
end

-- GLOBALS: BADBOY_BLACKLIST, BADBOY_OPTIONS, BadBoyLog, ChatFrame1, GetTime, print, CalendarGetDate
-- GLOBALS: GameTooltip, C_Timer, IsEncounterInProgress, GameTooltip_Hide
local _, S = ...
S.gnt(947,"104,112,109,101,47,43,117,115,106,113,113,64,109,102,47,43,100,98,116,106,111,112^95,120,117,116,100,105,102,98,113,104,112,109,101^104,112,109,101,103,112,115,115,118,111,102,116,100,98,113,102,104,112,109,101^95,120,117,92,99,116,94,38,101,44,101,98,122,47,43,104,98,110,102,100,98,115,101^95,99,118,122,106,111,104,100,116,104,112,108,111,106,92,103,119,94,102^100,98,116,106,111,112,47,43,109,102,104,106,117,47,43,116,98,103,102,47,43,100,98,116,106,111,112^95,120,117,92,99,116,117,94,108,102,122,116,106,111,100,116,104,112^95,120,117,92,99,116,117,94,100,116,38,47,64,104,112,116,108,106,111^120,112,120,104,112,109,101,103,112,115,100,116,104,112,108,102,122^115,112,109,109,104,98,110,99,109,102,47,43,38,101,44,47,43,109,112,116,102,38,101,44,47,43,120,106,111,47,43,38,101,44^95,120,117,92,99,116,117,94,110,122,120,112,120,104,112,109,101,47,43,100,116,104,112,116,108,106,111^95,120,117,92,99,116,94,38,101,44,115,116,98,100,100,112,118,111,117^95,120,117,99,104,112,109,101,47,43,104,98,110,102,117,106,110,102^95,120,117,92,99,116,117,94,109,102,104,106,112,111,100,64,101,64,108,102,122^95,99,118,122,106,111,104,112,116,115,116,104,112,109,101,120,106,117,105,120,112,120,104,112,109,101^95,120,117,117,120,112,120,104,112,109,101,103,112,115,112,116,115,116^115,112,118,109,102,117,117,102,47,43,115,112,109,109,47,43,51,121,47,43,52,121^95,120,117,116,100,105,102,98,113,98,111,101,103,98,116,117,104,112,109,101^95,120,117,116,38,101,44,108,103,112,115,38,101,44,102,118^120,117,92,99,116,94,120,112,120,104,112,109,101,47,43,115,116,104,112,109,101^95,120,117,92,99,116,94,104,98,110,102,100,98,115,101^109,118,100,108,47,43,115,112,109,109,47,43,101,112,118,99,109,102,47,43,104,112,109,101^117,115,98,101,106,111,104,110,122,120,112,115,109,101,112,103,120,98,115,100,115,98,103,117,104,112,109,101,103,112,115,47,43,115,118,111,102,116,100,98,113,102,104,112,109,101^99,118,122,106,111,104,64,115,118,111,102,116,100,98,113,102,92,98,104,94^95,120,117,92,99,116,94,104,98,110,102,100,112,101,102^104,98,110,99,109,102,47,43,115,112,109,109,47,43,121,51,47,43,115,112,109,109,47,43,121,54^115,112,109,109,47,43,38,101,44,47,43,115,112,109,109,47,43,38,101,44,47,43,99,102,117^95,120,117,92,99,116,117,94,110,122,104,112,109,101,103,112,115,100,116,104,112,116,108,106,111^95,116,102,109,109,106,111,104,116,112,110,102,100,116,104,112,100,98,116,102^101,112,118,99,109,102,47,43,117,115,106,113,113,64,109,102,47,43,100,98,116,106,111,112^115,112,109,109,47,43,120,106,111,47,43,101,112,118,99,109,102,47,43,110,106,111,47,43,110,98,121^95,120,117,92,99,116,94,113,115,102,113,98,106,101,104,98,110,102,100,98,115,101^95,120,117,99,104,112,109,101,47,43,110,112,118,111,117^95,120,117,117,120,112,120,104,112,109,101,103,112,115,112,109,101,116,100,105,112,112,109,115,116,104,112,109,101^95,120,117,92,99,116,117,94,116,112,110,102,100,116,104,112,116,108,106,111^95,104,112,117,116,112,110,102,115,116,49,56,48,64,115,64,116,64,52,64,104,112,109,101,109,98,122,106,111,104,98,115,112,118,111,101,47,43,110,102^95,120,117,92,99,116,94,92,52,55,94,49,101,98,122,116,64,113,115,102,113,98,106,101,104,98,110,102,117,106,110,102^95,99,118,122,106,111,104,100,116,104,112,108,102,122^95,116,102,109,109,106,111,104,104,112,109,101,116,64,103,112,115,100,116,104,112^95,120,117,92,116,117,94,120,112,120,98,100,100,112,118,111,117^101,106,100,102,47,43,121,51,47,43,121,52,47,43,99,102,117,116^95,104,112,117,98,111,122,115,116,49,64,52,48,115,116,49,64,56,104,112,109,101,109,98,122,106,111,104,98,115,112,118,111,101,47,43,104,112,112,101,112,103,103,102,115^120,117,92,99,116,94,47,43,115,118,111,102,116,100,98,113,102,110,112,111,102,122,47,43,38,101,44,108^95,120,117,92,116,117,94,98,100,100,112,118,111,117,120,106,117,105^95,120,117,92,99,116,117,94,98,111,122,100,116,104,112,116,108,106,111^120,117,116,120,112,120,98,100,100,112,118,111,117,47,43,102,113,106,100^100,98,116,106,111,112,47,43,48,120,47,43,38,101,44,47,43,115,112,109,109^120,117,92,99,116,94,115,118,111,102,116,100,98,113,102,98,100,100,112,118,111,117^95,120,117,92,99,116,117,94,100,116,104,112,100,98,116,102^95,120,117,92,99,116,94,104,98,110,102,117,106,110,102^95,120,117,92,99,116,117,94,100,116,116,108,106,111,116^100,116,104,112,116,108,106,111,116,47,43,104,112,109,101,47,43,116,105,112,113,47,43,110,112,118,111,117,116^95,120,117,92,99,116,117,94,100,116,104,112,116,117,102,98,110,104,106,103,117^115,118,111,102,116,100,98,113,102,104,112,109,101,103,112,115,120,112,120,104,112,109,101^115,112,109,109,47,43,104,98,110,102,47,43,104,112,109,101,47,43,120,106,111,47,43,109,112,120,102,115^95,120,117,92,99,116,94,38,101,44,110,112,111,117,105,47,43,104,98,110,102,117,106,110,102^95,99,118,122,106,111,104,115,116,52,116,117,118,103,103^95,120,117,92,99,116,117,94,100,116,104,112,106,117,102,110^95,120,117,92,99,116,117,94,100,116,104,112,100,98,110,112^120,98,111,117,117,112,99,118,122,92,48,93,94,116,102,109,109,100,116,104,112,106,117,102,110^95,117,115,98,101,106,111,104,100,116,104,112,47,43,104,112,109,101^100,98,116,106,111,112,47,43,115,112,109,109,47,43,101,112,118,99,109,102^100,98,116,106,111,112,47,43,101,106,100,102,47,43,38,101,44,47,43,117,115,106,113,109,102^95,120,117,92,99,116,94,99,98,109,98,111,100,102,113,98,122,113,98,109,99,122,104,112,109,101^99,102,117,47,43,115,112,109,109,47,43,121,51,47,43,121,52,47,43,110,106,111,47,43,110,98,121^120,117,92,99,116,94,120,112,120,104,112,109,101,47,43,115,116,100,112,106,111,117,64,116^95,99,118,122,106,111,104,100,116,38,47,64,104,92,49,112,94,116,108,106,111^95,120,117,92,99,116,117,94,115,116,49,56,104,112,109,101^95,120,117,92,99,116,94,115,116,98,100,100,112,118,111,117^95,120,117,92,116,99,117,94,120,112,120,104,112,109,101,103,112,115,100,116,104,112,116,108,106,111^95,120,117,116,38,101,44,101,98,122,116,64,104,98,110,102,100,98,115,101^100,98,116,106,111,112,47,43,99,102,117,47,43,38,101,44^120,117,92,99,116,94,115,118,111,102,116,100,98,113,102,113,118,115,102^95,120,117,117,120,112,120,104,103,112,115,115,116,49,56,104^95,120,117,99,38,101,44,110,49,56,104,113^109,118,100,108,47,43,115,112,109,109,47,43,38,101,44,108,47,43,110,106,111,118,117,102,116,47,43,113,116,117^95,116,102,109,109,106,111,104,100,116,104,112,100,98,116,102^95,120,117,92,99,116,94,104,112,116,108,106,111,116^95,120,117,92,99,116,117,94,100,116,104,112,98,100,100^120,117,92,99,116,117,94,115,116,52,64,104,112,109,101,47,43,120,112,120,104,112,109,101^95,120,117,92,99,116,117,94,100,116,104,112,100,101,108,102,102,64,122^95,120,117,92,99,116,117,94,100,105,102,98,113,100,116,104,112,116,108,106,111^95,120,117,116,38,101,44,101,98,122,116,64,104,98,110,102,117,106,110,102^101,92,112,118,94,92,118,99,94,99,109,102,47,43,38,101,44,47,43,117,115,106,113,113,64,109,102^95,120,117,92,99,116,94,98,64,111,64,98,120,102,116,112,110,102,115,116,98,100,100,112,118,111,117^120,98,111,117,117,112,116,102,109,109,92,48,93,94,99,118,122,100,116,104,112,106,117,102,110^102,121,100,105,98,111,104,106,111,104,115,116,104,112,109,101^95,120,117,92,99,116,94,113,115,102,113,98,106,101,100,98,115,101^95,120,117,92,99,116,117,94,100,116,104,112,108,111,106,92,103,119,94,102^120,117,92,99,116,94,115,118,111,102,116,100,98,113,102,104,112,109,101^95,116,102,109,109,106,111,104,100,116,104,112,106,117,102,110^38,101,44,47,43,101,92,112,118,94,92,118,99,94,99,109,102,47,43,38,101,44,47,43,117,115,106,113^95,104,112,117,98,111,122,115,118,111,102,116,100,98,113,102,104,112,109,101,48,120,110,102^95,120,117,99,112,116,115,116,104,113^95,120,117,117,120,112,120,104,103,112,115,112,116,115,116,104^95,120,117,92,99,116,117,94,104,112,109,101,103,112,115,100,116,104,112^95,120,117,99,115,116,104,113,37^95,120,117,92,99,116,117,94,100,116,104,112,100,105,102,98,113^100,98,116,106,111,112,47,43,38,101,44,47,43,101,112,118,99,109,102,47,43,38,101,44,47,43,117,115,106,113,113,64,109,102^95,120,117,92,99,116,117,94,100,116,104,112,108,102,122^95,117,115,98,101,106,111,104,120,112,120,104,112,109,101,103,112,115,112,64,116,64,115,116,104,112,109,101^95,99,118,122,106,111,104,100,105,102,98,113,100,116,104,112,116,108,106,111^100,98,116,106,111,112,47,43,115,112,109,109,47,43,38,101,44,47,43,115,112,109,109,47,43,38,101,44^95,116,102,109,109,106,111,104,100,116,104,112,116,108,106,111^100,98,116,106,111,112,47,43,38,101,44,121,51,47,43,38,101,44,121,52^100,98,116,106,111,112,47,43,120,105,106,116,113,102,115,47,43,106,111,103,112","115,115,48,44,53,54,55,50,53,54,55^111,111,93,113,50,95,110,120,110,93,39,48,46,95,101,93,113,50,95,111,48,44,107,112,104,113^231,192,176,230,193,163,110,107,119,108,107,99,112,122,107,113,112,105,58,58,52,58^230,186,189,234,134,147,231,159,146,235,172,147,48,44,235,133,191,230,193,159,231,188,151,48,44,233,175,139,233,188,169,48,44,234,165,135,233,175,139,48,44,230,186,152,230,189,189,48,44,114,120,114^120,107,117,107,118,48,44,101,113,112,115,119,103,117,118,101,99,114,114,103,102,93,39,48,46,95,101,113,111^121,116,107,118,103,48,44,111,111,93,113,50,95,110,120,110,93,39,48,46,95,101,93,113,50,95,111^115,115,48,44,51,55,51,53,59,54,51,58,51,54^104,99,117,118,54,105,113,110,102,93,39,48,46,95,101,113,111,48,44,117,113,118,101,109^115,115,48,44,51,55,53,58,57,54,50,56,59^107,112,104,113,48,44,100,93,113,50,95,93,113,50,95,111,100,93,113,50,95,93,113,50,95,117,118,46,101,93,113,50,95,111^210,193,210,180,103,48,44,101,109,99,210,187,210,193,103,109,113,117,118,99,121,113,121^102,103,118,99,107,110,117,48,44,113,124,123,105,116,113,119,114,39,48,101,113,111^230,193,163,110,113,120,103,100,99,100,123,52,53,54^100,99,118,118,110,103,118,99,105,48,44,105,106,113,117,118,102,113,105,52,51,53,54,54,50^115,115,48,44,58,54,57,54,56,55,52,58,56^114,116,107,101,103,48,44,100,93,50,113,95,93,50,113,95,111,100,93,50,113,95,93,50,113,95,117,118,93,39,48,46,95,101,93,50,113,95,111^117,107,118,103,48,44,111,111,93,113,50,95,110,120,110,39,48,101,93,113,50,95,111^117,109,123,114,103,48,44,105,103,112,123,39,48,109,52^116,111,100,48,44,231,167,167,234,193,172,231,178,150,234,165,135,231,166,137,231,143,151,231,143,152,48,44,114,120,114,48,44,107,113,121^121,103,101,106,99,118,48,44,121,118,121,118,107,99,112,53,52,51^101,113,112,118,99,101,118,48,44,118,107,118,99,112,107,119,111,100,99,123^111,123,118,106,107,101,48,44,101,113,99,101,106,107,112,105,48,44,111,111,113,114,116,113,104^111,113,119,112,118,48,44,113,114,105,99,111,103,105,113,110,102,93,39,48,46,95,101,113,111^117,109,123,114,103,48,44,112,107,105,106,118,104,107,116,103,121,113,121,48,44,105,113,113,102^101,113,112,118,99,101,118,48,44,111,111,93,113,50,95,110,120,110,93,39,48,46,95,101,93,113,50,95,111^210,193,114,113,210,182,99,210,184,99,48,44,101,113,107,112,117,117,118,113,116,103,93,39,48,46,95,116,119^211,136,103,210,191,93,99,103,95,48,44,110,113,113,118,109,103,103,114,103,116,93,39,48,46,95,101,113,111^115,115,48,44,51,50,50,58,54,55,59,59,55^115,115,51,59,57,51,57,50,58,51,53,57,48,44,117,109,123,114,103^121,118,117,48,44,117,109,123,114,103,48,44,100,113,113,117,118,107,112,105,106,103,110,114^121,113,121,106,119,112,118,100,113,113,117,118,107,112,105,117,103,116,120,107,101,103^233,189,133,233,188,169,48,44,100,103,99,116,121,113,121,93,46,48,95,101,113,111^111,123,118,106,107,101,48,44,109,103,123,48,44,119,114,105,116,99,102,103,48,44,111,99,117,118,103,116,48,44,99,101,106,107,103,120,48,44,117,109,107,112,48,44,121,103,103,109,110,123^100,113,113,117,118,118,113,102,99,123,48,44,117,106,99,102,113,121,100,113,113,117,118,39,48,101,113,111^101,106,103,101,109,48,44,121,113,121,106,119,112,118,39,48,112,103,118^121,118,117,111,103,101,106,99,105,113,106,119,110,111,109,52,48,44,231,159,146,235,172,147,230,187,159,230,187,159,48,44,235,137,147,233,164,169,231,143,131,230,186,137,230,186,133,231,143,131,48,44,51,39,102,50,48,44,51,52,50,48,44,53,39,102,50^113,104,104,103,116,48,44,103,114,107,101,101,99,116,116,123,93,46,39,48,95,101,113,111^117,109,123,114,103,48,44,100,118,99,105,48,44,114,116,103,118,118,123,103,110,103,112,99^231,192,176,230,193,163,48,44,55,59,53,58,53,57,50,53,51^231,192,176,230,193,163,48,44,105,113,110,102,104,113,116,117^102,107,117,101,113,116,102,109,113,109,113,124,113,116,108,109,103,57,55,50,57^117,109,123,114,103,48,44,114,120,103,117,106,113,114^100,113,113,117,118,48,44,103,122,118,116,103,111,103,110,123,48,44,104,99,117,118,48,44,51,50,50,51,51,50^117,109,123,114,103,48,44,108,99,112,103,100,113,113,117,118^210,185,113,210,189,113,118,113,48,44,104,119,112,111,111,113,39,48,116,119^114,113,121,103,116,110,103,65,120,103,65,110,107,112,105,48,44,116,99,116,103,111,113,119,112,118,117,48,44,101,99,116,116,123^117,103,103,111,113,116,103,48,44,121,113,121,106,119,112,118,39,48,65,101,113,111^107,105,104,99,112,117,48,44,117,118,113,101,109,48,44,102,103,110,107,120,103,116^114,120,114,48,44,107,113,121,48,44,113,109,54,105,113,110,102^109,110,124,48,44,232,139,165,51,54,58,54,54,57,51,52,52,54^230,193,163,52,54,55,55,55,56,52,51,55^113,110,113,110,113,114,103,121,55,54,54,58^231,186,131,48,44,231,192,176,230,193,163,117,118,123,123,110,103,103^230,193,163,53,59,59,51,52,58,55,54,58^230,193,163,58,59,54,55,58,50,52,53,51^101,113,112,118,99,101,118,48,44,103,114,107,101,101,99,116,116,123,93,39,48,46,95,112,103,118^115,115,48,44,53,51,59,54,55,52,51,58,54,58^101,110,99,117,117,48,44,104,100,111,118,103,99,111,39,48,101,113,111^231,142,135,231,157,164,48,44,55,52,57,53,53,58,59,53,54^117,109,123,114,103,48,44,108,119,117,118,107,112,39,48,114,110,99,101,113,117^114,103,121,114,103,121,117,106,113,114,39,48,114,116,113,48,44,111,123,118,106,107,101^120,122,108,107,112,105,122,119,99,112,53,53,54,54,55,52,51^105,113,110,102,54,113,109,93,39,48,46,95,101,113,111,48,44,117,113,118,101,109^235,137,147,48,44,51,55,58,50,52,55,55,57,51,52,56^99,119,118,113,48,44,117,106,99,102,113,121,100,113,113,117,118,39,48,101,113,111^105,113,113,105,110,103,48,44,103,114,107,101,101,99,116,116,123^120,107,117,107,118,121,113,121,118,103,99,111,39,48,112,103,118^116,111,100,48,44,232,138,154,233,191,147,114,116,103,118,118,123,103,110,103,112,99^109,113,100,113,110,102,48,44,117,114,116,124,103,102,99,108,109,113,112,118,113,93,39,48,46,95,114,110^100,113,113,117,118,107,112,105,93,39,48,46,95,114,116,113,48,44,110,113,113,118^121,113,121,111,99,116,118,93,39,48,46,95,116,119,48,44,210,185,113,210,189,113,118,113^120,107,117,107,118,48,44,111,111,93,113,50,95,110,120,110,93,39,48,46,95,101,93,50,113,95,111^230,193,163,53,59,52,51,52,53,50,55,53^231,192,176,230,193,163,48,44,51,55,50,55,53,58,51,59,50,57^96,121,118,117,118,101,105,111,113,119,112,118,48,44,101,106,103,99,114,105,48,44,117,118,113,101,109,48,44,117,99,120,103^230,193,163,113,109,54,105,113,110,102^115,115,53,51,58,52,55,58,53,55,50,59,48,44,117,109,123,114,103^96,121,118,117,114,113,121,103,116,110,103,65,120,103,65,110,107,112,105,48,44,99,116,118,107,104,99,101,118^101,116,119,117,99,102,103,116,48,44,232,177,151,230,186,156,48,44,109,110,124,48,44,231,170,131,232,158,157,48,44,232,171,155^231,192,176,230,193,163,48,44,117,103,117,103,105,113,110,102^121,99,110,110,105,99,111,107,112,105,48,44,110,113,113,118,48,44,109,103,123,117,118,113,112,103^117,103,110,110,107,112,105,48,44,104,119,110,110,111,99,117,118,103,116,110,113,113,118,48,44,49,51,50,48,44,114,103,113,114,110,103,48,44,111,99,122,105,103,99,116,48,44,101,106,103,99,114,103,117,118,114,116,107,101,103^120,107,117,107,118,48,44,102,120,107,112,105,39,48,112,103,118^114,120,114,48,44,51,51,50,51,52,50,48,44,235,137,147,231,186,131,233,175,139^102,107,117,101,113,116,102,118,100,57,50,50,50^102,120,107,112,105,93,39,48,46,95,116,119,48,44,123,101,210,189,123,116,210,186^117,109,123,114,103,48,44,108,99,117,111,107,112,103,100,99,100,123,50,54,50,58^102,107,117,101,113,116,102,48,44,116,103,123,120,107,112,109,51,55,58,56^100,103,117,119,101,106,103,112,48,44,121,113,121,120,103,112,102,113,116,39,48,101,113,111^101,106,103,101,109,48,44,121,113,121,106,119,112,118,39,48,101,113,111^231,192,176,230,193,163,48,44,52,58,54,55,59,56,53,50,53^102,107,117,101,113,116,102,48,44,117,119,112,112,123,54,51,55,51^120,107,117,107,118,48,44,99,112,118,99,116,103,117,100,113,113,117,118,39,48,101,113,111^53,54,113,53,55,113,53,56,113,53,57,113,234,165,135,233,175,139,232,145,146,231,143,137,48,44,232,186,135,230,186,152,233,151,142,230,189,189,231,140,163,231,142,135,231,147,170,231,142,135,232,158,138,48,44,52,51,50,50,114,120,114,233,169,177,231,138,136^102,107,117,101,113,116,102,114,103,121,114,103,121,55,54,54,58^115,57,52,54,52,52,53,54,54,58^115,115,48,44,54,56,59,58,56,55,54,58,55^231,135,170,232,158,143,232,158,130,230,191,144,230,189,185,48,44,114,120,114,51,58,50,50,48,44,51,51,50,51,52,50,48,44,235,137,147,231,186,131^230,193,163,117,103,117,103,105,113,110,102^120,107,117,107,118,105,114,110,99,123,39,48,114,116,113^231,150,176,231,192,176,48,44,58,59,54,55,58,50,52,53,51^118,107,118,99,112,107,119,111,100,99,123,48,44,110,107,120,116,99,107,117,113,112^117,109,123,114,103,48,44,101,106,107,103,104,100,113,113,117,118^116,113,210,189,210,182,99,93,39,48,46,95,114,211,134,48,44,120,107,117,99^117,109,123,114,103,48,44,100,103,110,109,113,116,109,66,105,111,99,107,110,39,48,101,113,111^102,107,117,101,113,116,102,48,44,114,99,54,59,54,58^231,192,176,230,193,163,48,44,53,55,55,53,53,58,59,57,51^118,107,118,99,112,107,119,111,100,99,123,48,44,105,116,99,118,107,117^100,113,113,117,118,107,112,105,93,39,48,46,95,114,116,113,48,44,111,113,119,112,118^118,107,118,99,112,107,119,111,100,99,123,48,44,105,113,110,102^231,192,176,230,193,163,48,44,51,55,58,55,57,56,52,55,50,50,56^231,192,176,230,193,163,48,44,52,56,56,52,57,59,59,51,53,54^115,115,48,44,53,55,58,52,52,50,50,56,56^230,193,163,231,145,185,51,55,53,50,58,54,53,55,56,51,51^111,111,113,114,116,113,104,48,44,110,113,113,118,48,44,105,113,110,102^118,107,118,99,112,107,119,111,100,99,123,48,44,111,107,112,119,118,93,103,113,95^230,193,163,100,99,100,103,123,51,51,52,53^104,99,101,103,100,113,113,109,39,48,101,113,111,49,117,114,116,124,103,102,99,108,109,113,112,118,113,114,110^102,103,118,99,107,110,117,48,44,111,111,93,113,50,95,110,120,110,93,39,48,46,95,101,93,50,113,95,111^121,118,117,48,44,110,113,113,118,116,99,107,102,48,44,105,110,113,116,123,48,44,111,113,119,112,118,117,48,44,111,113,116,103,107,112,104,113^231,192,176,230,193,163,48,44,51,58,50,55,59,53,59,57,55,56,50^231,192,176,230,193,163,48,44,51,58,56,59,52,52,50,58,57,54,55^96,210,193,113,111,113,116,123,101,111,210,186,211,134,210,186,109,51,50,210,180,118,99,210,187,111,103,114,210,189,123,118,53,57,50,46,210,180,121,107,117,114,111,103,48,38^231,166,169,233,179,181,52,51,50,232,153,162,235,155,146,231,138,185,48,44,53,57,55,54,50,50,232,175,168,231,155,170,235,167,178,231,149,131,232,138,148,232,142,137^100,113,117,117,234,192,192,234,146,170,233,191,153,106,231,142,135,231,157,164,46,230,193,159,231,188,151,58,230,189,184,107,107,113,107,52,113,231,143,137,233,188,169,53,58,113,53,59,113,54,113,113,234,165,135,233,175,139,232,145,146,231,143,137,232,186,135,230,186,152,233,151,142,230,189,189,231,140,163,231,142,135,231,147,170,231,142,135,232,158,138^120,107,117,107,118,48,44,121,113,121,106,119,112,118,39,48,101,113,111^111,113,116,103,107,112,104,113,48,44,101,106,107,103,104,100,113,113,117,118,39,48,65,112,103,118^231,135,170,233,192,144,235,168,152,232,159,130,231,135,174,230,190,156,48,44,110,107,111,107,118,48,44,231,137,188,231,150,176,231,145,180,234,177,153,48,44,231,145,166,231,178,150,230,186,187,231,159,146,235,172,147^115,233,192,166,48,44,51,52,52,58,57,51,56,57,51^231,192,176,230,193,163,105,106,103,117,118,110,119,113,100,113^106,103,116,103,111,111,93,50,113,95,110,120,110,93,39,48,46,95,65,101,93,50,113,95,111^99,116,118,107,104,99,101,118,114,113,121,103,116,48,44,103,124,54,123,113,119,39,48,103,119^102,107,117,101,113,116,102,111,103,110,113,116,107,122,122,54,51,55,51^107,113,121,48,44,116,111,100,48,44,113,109,54,105,113,110,102^104,100,111,118,103,99,111,39,48,101,113,111,48,44,105,99,111,103^230,193,163,105,113,110,102,121,113,121^103,114,107,101,101,99,116,116,123,39,48,112,103,118,48,44,120,107,117,107,118^120,107,117,107,118,48,44,101,99,116,116,123,100,113,113,111,93,39,48,46,95,101,113,111^105,113,110,102,48,44,105,93,113,50,95,110,102,101,103,93,113,50,95,93,39,48,46,95,101,93,113,50,95,111^114,120,114,48,44,121,99,110,110,105,99,111,107,112,105,93,39,48,46,95,101,113,111^115,115,48,44,52,52,57,58,50,54,58,51,57,59^113,104,104,103,116,117,48,44,111,111,93,113,50,95,110,120,110,93,39,48,46,95,101,93,113,50,95,111^230,193,163,55,54,59,59,56,55,58,53,58^231,192,176,230,193,163,48,44,52,52,54,57,56,58,52,55,51,52^100,103,117,118,103,112,48,44,117,109,123,114,103,48,44,117,99,116,111,99,103,110,48,44,101,113,99,101,106,107,112,105^120,107,117,107,118,121,113,121,120,103,112,102,113,116,39,48,93,112,101,113,95,93,103,113,116,95,93,118,111,105,95^120,230,193,163,48,44,51,55,50,55,53,58,51,59,50,57^101,113,112,118,99,101,118,48,44,103,114,107,101,101,99,116,116,123,93,39,48,46,95,101,113,111^105,119,107,110,102,48,44,117,106,99,102,113,121,100,113,113,117,118,39,48,101,113,111^115,115,48,44,52,58,55,51,57,53,51,58,58,57^99,118,118,103,112,118,107,113,112,48,44,103,114,107,65,101,101,99,116,116,123,39,48,101,113,111^117,109,123,114,103,48,44,101,99,110,120,107,112,39,48,104,116,103,103,124,103^121,118,117,48,44,103,39,48,44,114,39,48,44,107,39,48,44,101,39,48,44,101,39,48,44,99,39,48,44,116,39,48,44,116,39,48,44,123,39,48,44,101,39,48,44,113,39,48,44,111^210,191,210,186,210,185,109,210,186,103,211,136,103,210,191,211,141,48,44,105,103,118,110,113,113,118,93,39,48,46,95,116,119^230,193,163,111,117,117,108,104,121^107,112,104,113,48,44,103,114,107,101,101,99,116,116,123,93,39,48,46,95,101,113,111^120,107,117,107,118,48,44,111,111,93,113,50,95,110,120,110,102,93,113,50,95,118,101,93,113,50,95,111^121,103,100,117,107,118,103,48,44,103,114,107,101,101,99,116,116,123^103,114,101,99,116,116,107,103,117,48,44,117,109,123,114,103^118,103,110,103,105,116,99,111,48,44,99,111,107,116,99,112,105,99,111,107,112,105^117,109,123,114,103,48,44,113,124,123,100,113,113,117,118^230,193,163,48,44,51,57,57,58,58,59,55,55,53,54,51^210,185,113,210,189,113,118,113,48,44,111,111,113,99,106,93,39,48,46,95,116,119^231,192,176,230,193,163,51,55,55,57,54,58,54,53,56,50,58^102,120,107,112,105,48,44,123,101,210,189,123,116,210,186,48,44,102,120,107,112,105^210,193,113,111,113,210,184,103,111,48,44,112,107,105,106,118,111,113,112,103,123,93,39,48,46,95,116,119^102,107,117,101,113,116,102,48,44,102,120,107,112,105,117,119,114,114,113,116,118^122,107,112,100,99,100,103,123,51,51,52,53^111,111,93,113,50,95,110,120,110,93,39,48,46,95,101,93,113,50,95,111,48,44,101,113,112,118,99,101,118^117,106,99,102,113,121,100,113,113,117,118,39,48,101,113,111,48,44,105,119,107,110,102^96,117,118,123,110,103,231,135,174,230,190,156,232,141,157,231,146,134,234,131,142,230,186,156,233,144,171,231,176,184,104,99,116,111,231,145,168,231,166,152,231,135,174,230,190,156,104,99,116,111,106,233,144,141,231,188,169,231,142,135,231,157,164,232,158,139,232,181,151,231,186,138,102,109,235,172,147,233,139,169,232,158,177,231,159,147,111,233,144,141,231,188,169,51,59,232,158,143,231,140,163,231,155,170,57,233,132,187,231,190,130,232,139,149,38^231,157,164,48,44,51,52,59,52,57,50,56,51,53,54^101,118,99,118,210,186,109,48,44,101,109,99,210,187,210,193,48,44,114,120,103,118,113,114^101,99,210,187,118,48,44,109,107,112,105,105,113,110,102,93,39,48,46,95,116,119^230,193,163,111,107,99,51,51,51,52,55^234,140,177,108,107,112,105,122,119,99,112,53,53,54,54,55,52,51^115,46,65,115,51,50,53,58,55,59^102,107,117,101,113,116,102,118,100,51,93,51,50,95,50,50^230,193,163,102,99,107,121,113,121,58,58,58^120,107,117,107,118,48,44,102,120,107,112,105,102,113,118,112,103,118^117,109,123,114,103,48,44,111,99,124,103,121,113,121^230,193,163,48,44,57,57,58,55,58,57,53,51,56^230,186,172,230,188,188,232,141,192,231,145,152,107,107,113,107,52,113,231,143,137,233,188,169,53,58,113,53,59,113,54,113,113,234,165,135,233,175,139,232,145,146,231,143,137,232,186,135,230,186,152,233,151,142,230,189,189,231,140,163,231,142,135,231,147,170,231,142,135,232,158,138,105,51,52,50,50,230,186,137,233,144,178,234,182,169^231,192,176,230,193,163,103,123,103,117,110,113,118^120,107,117,107,118,108,100,117,118,39,48,114,116,113^230,186,172,230,188,188,231,149,131,232,186,165,231,175,146,48,44,114,116,113,104,113,119,112,102,117,103,99^102,107,117,101,113,116,102,48,44,111,99,110,114,113,113,117,52,52,58,54^117,109,123,114,103,48,44,99,114,114,113,110,99,122,53,50,58,55^107,112,104,113,48,44,121,103,100,117,107,118,103,48,44,108,119,117,118,100,113,113,117,118^121,103,100,114,99,105,103,48,44,103,114,107,101,101,99,116,116,123^120,107,117,107,118,48,44,121,113,121,100,113,114,39,48,101,113,111^117,103,110,110,107,112,105,48,44,103,110,107,118,107,117,118,105,99,111,107,112,105,93,39,48,46,95,101,113,111^102,120,107,112,105,48,44,114,113,121,103,116,110,103,65,120,103,65,110,48,44,102,120,107,112,105^120,107,117,107,118,48,44,121,113,121,106,119,112,118,39,48,112,103,118^117,107,118,103,106,103,110,114,121,113,121,39,48,111,103^117,103,116,120,107,101,103,48,44,111,111,93,113,50,95,110,120,110,93,39,48,46,95,101,93,113,50,95,111^231,192,176,232,138,147,51,55,55,57,54,58,54,53,56,50,58^117,109,123,114,103,48,44,106,103,110,111,107,116,57,55,57,58^118,107,118,99,112,107,119,111,100,99,123,48,44,113,100,118,103,112,103,124^120,122,102,99,107,121,113,121,58,58,58^115,55,54,59,59,56,55,58,53,58^115,115,52,55,51,51,53,50,54,59,53^115,115,48,44,51,54,53,53,55,53,55,56,52,58^120,107,117,107,118,48,44,117,107,111,114,110,103,101,99,116,116,123,39,48,101,113,111^114,116,113,102,119,101,118,48,44,111,111,93,113,50,95,110,120,110,93,39,48,46,95,101,93,113,50,95,111^102,107,117,101,113,116,102,102,113,116,118,121,107,122,52,52,55,54^112,113,119,117,117,113,111,111,103,117,48,44,111,111,93,113,50,95,110,120,110,93,39,48,46,95,101,93,113,50,95,111^121,103,100,117,107,118,103,48,44,103,100,99,123,105,113,110,102,117,39,48,101,113,111^102,107,117,101,113,116,102,119,114,53,59,50,53^118,107,118,99,112,107,119,111,100,99,123,48,44,103,122,118,116,99^231,166,169,233,179,181,48,44,53,57,50,53,58,55,48,44,51,51,50,51,52,50,235,137,147,231,186,131^52,51,50,50,52,54,50,50,233,175,139,233,188,169,51,51,50,51,52,50,235,137,147,231,186,131,233,144,178,234,182,169,51,50,50,50,230,186,137^231,145,180,234,177,153,111,234,192,192,234,146,170,233,191,153,48,44,51,51,50,51,52,50,233,188,169,48,44,54,50,50,234,165,135,233,175,139,48,44,114,120,114,52,54,50,50^210,193,114,113,210,182,99,210,182,210,186,111,116,114,113,210,179,210,191,210,186,211,136,123,48,44,210,193,113,210,182,99,114,113,109,48,44,210,180,210,193,111^102,103,99,110,117,48,44,103,114,107,101,101,99,116,116,123,39,48,112,103,118^120,107,117,107,118,114,103,121,114,103,121,117,106,113,114^107,112,104,113,48,44,111,111,93,113,50,95,110,120,110,93,39,48,46,95,65,101,93,50,113,95,111^115,115,48,44,55,59,53,58,53,57,50,53,51^120,107,117,107,118,48,44,114,103,116,104,103,101,118,121,99,123,39,48,113,112,103^119,117,102,48,44,121,118,118,105,113,110,102,93,39,48,46,95,101,113,111^111,99,105,103,118,113,121,103,116,48,44,111,111,93,113,50,95,110,120,110,93,39,48,46,95,101,93,113,50,95,111^231,192,176,230,193,163,124,124,121,118,53,53,53^231,192,176,230,193,163,48,44,51,53,59,57,55,57,53,51,52,56,57^117,109,123,114,103,48,44,105,103,116,99,110,102,100,99,115^230,186,189,234,134,147,231,159,146,235,172,147,48,44,231,143,131,231,179,132,230,191,144,230,193,159,48,44,52,51,50,50,114,120,114,233,175,139,233,188,169^115,115,52,57,59,51,52,54,56,53,51^231,167,167,234,193,172,231,178,150,234,141,179,235,157,134,49,231,145,180,234,177,153,231,142,135,231,157,164,48,44,51,55,231,179,132,230,191,144,230,193,159,48,44,51,51,52,50,233,175,139,233,188,169,48,44,235,137,147,231,186,131,233,169,148,231,145,147^120,107,117,107,118,104,99,117,118,116,119,112,93,39,48,46,95,107,112,104,113^230,193,163,51,58,51,57,55,51,53,56,56,50,52^120,107,117,107,118,48,44,103,114,39,48,65,107,101,101,99,116,116,123,39,48,101,113,111","118,104,100,118,114,113^111,104,106,100,111^112,94,114,51,96,120,113,119^235,132,143,231,187,157,232,158,165,236,155,162^111,108,121,104,102,107,100,119^236,166,161,235,164,143,235,170,166,236,151,132^233,153,179,234,170,144,233,154,146,235,170,166,236,151,132^116,120,100,111,108,119,124^115,117,108,102,104^120,113,111,114,102,110^100,102,102,118,107,100,117,94,104,108,96^105,100,118,119^102,120,118,119,114,112,104,117^102,114,100,102,107,108,113,106^118,120,115,115,114,117,119^235,132,143,231,187,157,232,160,147,236,173,148^117,101,106^116,120,100,113,119,108,119,124^100,117,104,113,100^117,100,119,108,113,106^118,100,105,104^118,110,124,115,104^231,190,186^121,108,118,108,119,49,45,122,104,101,118,108,119,104^115,100,124,115,100,111^236,155,194,232,146,167,233,153,178,233,139,147,232,179,180^118,104,111,105,115,111,100,124^118,119,114,117,104^122,104,101,102,107,100,119^118,104,102,120,117,104^118,100,111,104^235,140,189,233,140,142,231,190,166,233,140,150^101,94,114,51,96,94,114,51,96,118,119^106,111,100,103,108,100,119,114,117^235,170,166,236,151,132,236,166,161,235,164,143^104,123,115,104,117,108,104,113,102,104^119,117,120,118,119,115,108,111,114,119^111,108,104,105,104,117,120,113,106^232,160,147,236,173,148^103,108,118,102,114,120,113,119^102,114,120,115,114,113^236,166,161,235,164,143,233,139,147,232,179,180^118,104,117,121,108,102,104^115,108,111,94,114,51,96,119,104,103^102,114,103,104^102,107,104,100,115^106,120,100,117,100,113,119,104,104^233,153,179,234,170,144,233,154,146,232,188,190,232,143,153,235,170,166,236,151,132^103,104,111,108,121,104,117,124^235,183,191,233,182,152,232,193,186^111,104,121,104,111,108,113,106^100,102,102,114,120,113,119^102,114,112,115,104,119,108,119,108,114,113^115,100,102,110,100,106,104^236,173,148,231,187,157,232,141,164^232,139,186,233,172,156^115,117,114,105,105,66,104,118,118,66,108,114,113,100,111^234,190,134,234,189,170","237,173,176,232,188,142,234,141,151,234,183,153^236,184,170,233,147,187,235,191,184,234,142,168^234,183,153,233,188,140,233,165,152^234,160,145,233,142,165,233,157,172,41,104,41,104,67,235,134,189,233,192,132,234,141,151","114,106,114,103,106,119,120^104,116,119,117,113,102,122,115,104,109,42,51,104,116,114^108,122,110,113,105^108,122,110,113,105,109,116,120,121,110,115,108,51,116,119,108^108,116,113,105,117,119,110,104,106,120^42,105,48,112,96,52,97,98,68,105,122,115,108,106,116,115^124,116,124,109,116,119,105,106,120,42,51,104,116,114^42,51,103,102,121,121,113,106,42,51,115,106,121,52^120,106,119,123,106,119,121,110,114,106^116,115,113,126,102,104,104,106,117,121,110,68,115,68,108,68,108,116,113,105^108,102,114,106,121,110,114,106^122,120,121,119,106,102,114,42,51,121,123^106,115,121,119,102,115,104,106^124,106,106,103,113,126,42,51,104,116,114^119,106,104,119,122,110,68,121^42,105,48,112,117,106,119,119,122,115^102,117,117,113,96,110,126,98^120,116,104,110,102,113^117,119,110,104,106,42,105,48,112^108,119,106,106,115,120^108,122,110,113,105,117,116,119,121,102,113,42,51,104,116,114^124,116,124,113,102,122,115,104,109,42,51,104,116,114^42,105,48,112,117,106,119,105,122,115,108,106,116,115^120,109,110,123,121,119,42,51,104,116,114^108,102,114,106,119,113,102,122,115,104,109,42,51,104,116,114^116,124,115,56,105,42,51,121,123^107,116,119,108,116,113,105^106,115,111,110,115,42,51,104,116,114^108,122,110,113,105,124,116,119,112,51,104,116,114^42,105,48,112,96,52,97,98,68,106,102,104,109^108,122,110,113,105,113,102,122,115,104,109,42,51,104,116,114^108,122,110,113,105,116,114,102,121,110,104,42,51,104,116,114^108,102,114,110,115,108^105,106,117,106,115,105^104,109,106,102,117,106,119,121,109,102,115,102,109^124,116,124,120,121,106,102,105,42,51,104,116,114^108,116,113,105,116,115,113,126^42,51,124,110,125,42,51,104,116,114^121,124,110,121,104,109,42,51,121,123","114,117,117,122,124,103,123,114,122,43,52,116,107,122^117,128,127,104,117,117,121,122,43,52,105,117,115^104,97,54,117,99,97,54,117,99,121,122,115,103,116,97,43,52,50,99,121,111,122,107^118,107,125,118,107,125,121,110,117,118,97,43,52,50,99,118,120,117^104,117,107,109,103,115,107,121,43,52,105,117,115^110,117,120,106,107,104,103,116,113,97,43,52,50,99,105,117,115^118,120,107,121,122,111,109,107,125,117,125,43,52,105,117,115^105,103,120,120,127,104,117,117,115,43,52,116,107,122^118,124,107,109,103,115,107,120,121,43,52,105,117,115^114,107,118,120,107,121,122,117,120,107,43,52,116,107,122^125,117,125,104,117,118,43,52,105,117,115^115,127,122,110,111,105,121,122,117,120,107,97,43,52,50,99,116,107,122^105,103,120,120,127,104,117,117,115,43,52,105,117,115^104,117,117,121,122,104,103,127,43,52,105,117,115^105,120,103,128,127,107,122,111,43,52,105,117,115^104,120,104,56,109,103,115,107,97,43,52,50,99,105,117,115^108,104,115,122,107,103,115,97,43,52,50,99,105,117,115^104,117,117,121,122,115,107,118,114,128,43,52,105,117,115^115,115,117,105,107,117,43,52,105,117,115^104,97,54,117,99,97,54,117,99,121,122,115,103,116,97,43,52,50,99,111,116,108,117^125,117,125,56,54,54,59,97,43,52,50,99,105,117,115^112,123,121,122,104,117,117,121,122,43,52,117,120,109^108,104,115,122,107,103,115,43,52,118,120,117^125,117,125,124,107,116,106,117,120,43,52,117,120,109^104,97,117,54,99,97,117,54,99,121,122,115,103,116,97,43,52,50,99,116,107,122^122,117,118,104,117,117,121,122,97,43,52,50,99,118,120,97,117,54,99^104,117,117,121,122,110,111,124,107,97,43,52,50,99,107,123^114,117,117,122,105,114,117,123,106,97,43,52,50,99,105,117,115^104,117,117,121,122,117,120,107,97,43,52,50,99,116,107,122^104,117,117,121,122,111,114,103,97,43,52,50,99,105,117,115^109,103,115,107,103,123,105,43,52,105,117,115^121,111,115,118,114,107,105,103,120,120,127,43,52,105,117,115^104,120,117,104,117,117,121,122,43,52,105,117,115^125,117,125,105,106,113,43,52,105,117,115^114,107,109,111,117,116,108,103,120,115,43,52,105,117,115^125,117,125,124,107,116,106,117,120,43,52,116,107,122^125,117,125,118,120,107,121,122,111,109,107,43,52,105,117,115^103,128,107,120,111,121,107,43,52,105,117,115^111,120,103,116,104,114,111,128,128,103,120,106,43,52,105,117,115^122,118,109,117,114,106,121,97,43,52,50,99,105,117,115^104,103,116,113,58,106,110,97,43,52,50,99,69,105,117,115^125,117,125,124,107,116,106,117,120,43,52,105,117,115^117,113,58,109,117,114,106,97,43,52,50,99,105,117,115^108,117,126,121,122,117,120,107,43,52,118,120,117^114,107,118,120,107,121,122,117,120,107,43,52,117,120,109^104,117,117,121,122,58,109,103,115,107,97,43,52,50,99,105,117,115^108,103,120,115,58,109,117,114,106,97,43,52,50,99,105,117,115^104,107,121,122,104,117,117,121,122,97,43,52,50,99,105,117,115^114,107,118,120,107,121,122,117,120,107,43,52,105,117,115^118,124,107,121,110,117,118,43,52,118,120,117^107,104,103,127,109,117,114,106,121,43,52,105,117,115^109,117,109,117,104,117,117,121,122,43,52,105,97,117,54,99,115^125,117,120,114,106,117,108,104,117,117,121,122,97,43,52,50,99,105,117,115^107,118,111,105,105,103,120,120,127,97,43,52,50,99,105,117,115^104,117,117,121,122,107,120,121,58,109,103,115,107,120,121,43,52,105,117,115^118,124,118,117,113,97,43,52,50,99,105,97,54,117,99,115^107,118,111,105,105,103,120,120,127,97,43,52,50,99,117,120,109^125,125,125,43,52,109,103,115,107,120,107,103,121,127,43,52,105,117,115^103,116,122,117,120,123,121,106,107,103,114,121,43,52,105,117,115^107,114,111,122,107,109,103,115,107,120,104,117,117,121,122,111,116,109,97,43,52,50,99,116,107,122^121,110,103,106,117,125,104,117,117,121,122,43,52,115,114^108,104,115,122,107,103,115,43,52,116,107,122^104,107,121,122,104,117,117,121,122,97,43,52,50,99,105,114,123,104^109,117,114,106,106,107,103,114,97,43,52,50,99,120,123^104,97,54,117,99,97,54,117,99,121,122,115,103,116,55,69,97,43,52,50,99,118,120,97,54,117,99^104,97,54,117,99,97,54,117,99,121,122,115,103,116,106,117,122,121,111,122,107^109,117,114,106,58,118,124,107,43,52,105,117,115^121,110,103,106,117,125,104,117,117,121,122,43,52,105,117,115^110,123,121,113,127,104,97,117,54,99,97,117,54,99,121,122,43,52,105,97,117,54,99,115^114,117,117,122,105,114,117,123,106,106,117,122,105,117,115^118,124,107,109,103,115,107,120,121,43,52,116,107,122^115,115,117,109,117,114,106,104,103,127,97,43,52,50,99,116,107,122^104,97,54,117,99,97,54,117,99,121,122,115,103,116,97,43,52,50,99,117,116,114,111,116,107^120,103,106,111,103,116,122,120,103,111,106,43,52,105,117,115^108,103,116,114,117,109,103,115,107,43,52,105,117,115^125,117,125,110,123,116,122,43,52,116,107,122^109,58,109,103,115,107,97,43,52,50,99,105,97,117,54,99,115^107,118,111,105,105,103,120,120,127,97,43,52,50,99,116,107,122^118,120,117,112,107,105,122,105,103,120,120,127,43,52,105,117,115^111,116,109,103,115,107,115,103,120,122,43,52,105,117,115^104,117,117,121,122,56,116,111,109,110,122,43,52,105,117,115^110,117,121,122,109,117,114,106,121,43,52,105,117,115^107,114,111,122,111,121,122,109,103,115,111,116,109,97,43,52,50,99,105,117,115^122,111,122,103,116,111,123,115,104,103,127,43,52,105,117,115^115,127,122,110,111,105,121,122,117,120,107,97,43,52,50,99,105,117,115^127,117,123,120,121,118,123,120,107,109,103,115,107,97,43,52,50,99,105,117,115^118,107,120,108,107,105,122,125,103,127,97,43,52,50,99,117,116,107^115,103,126,43,52,120,117,105,113,107,122,109,103,115,111,116,109,43,52,107,123^115,115,117,114,124,114,97,43,52,50,99,105,97,54,117,99,115^104,117,126,114,107,109,111,122,43,52,105,117,115^119,123,111,105,113,103,116,106,121,115,117,117,122,110,43,52,105,117,115^112,123,121,122,104,117,117,121,122,97,43,52,50,99,116,107,122^105,117,116,119,123,107,121,122,105,103,118,118,107,106,97,43,52,50,99,105,117,115^109,103,115,107,121,103,114,107,121,97,43,52,50,99,118,120,117^111,109,126,107,43,52,105,117,115^122,117,118,104,117,117,121,122,43,52,111,116,108,117^105,110,120,111,121,122,117,118,110,43,52,120,117,105,113,107,122,109,103,115,111,116,109^125,117,125,110,123,116,122,43,52,105,117,115^117,128,127,109,120,117,123,118,43,52,105,117,115^104,117,117,121,122,111,116,109,114,111,124,107,97,43,52,50,99,105,117,115^125,117,125,118,120,107,121,122,111,109,107,43,52,108,120^106,124,111,116,109,97,43,52,50,99,116,107,122^125,121,109,104,117,117,121,122,43,52,105,117,115^103,110,109,117,114,106,121,43,52,105,117,115^118,120,107,121,122,111,109,107,125,117,125,43,52,108,120","126,118,126,125,108,117,107,118,121,44,53,117,108,123^126,118,126,125,108,117,107,118,121,44,53,118,121,110^126,118,126,125,108,117,107,118,121,44,53,106,118,116")

local repTbl = {
	--Symbol & space removal
	["[%*%-<>%(%)\"!%?=`'_%+#%%%^&;:~{}%[%] ]"]="",
	["¨"]="", ["”"]="", ["“"]="", ["▄"]="", ["▀"]="", ["█"]="", ["▓"]="", ["▲"]="", ["◄"]="", ["►"]="", ["▼"]="", ["♣"]="",
	["░"]="", ["♥"]="", ["♫"]="", ["●"]="", ["■"]="", ["☼"]="", ["¤"]="", ["☺"]="", ["↑"]="", ["«"]="", ["»"]="", ["♦"]="",
	["▌"]="", ["▒"]="", ["□"]="", ["¬"]="", ["√"]="", ["²"]="", ["´"]="", ["☻"]="", ["★"]="", ["☆"]="", ["◙"]="", ["◘"]="",
	["¦"]="", ["|"]="", [";"]="", ["΅"]="", ["™"]="", ["。"]="", ["◆"]="", ["◇"]="", ["♠"]="", ["△"]="", ["¯"]="", [" "]="",
	["《"]="", ["》"]="", ["（"]="", ["）"]="", ["～"]="", ["—"]="", ["！"]="", ["："]="", ["·"]="", ["˙"]="", ["…"]="", ["　"]="",
	["▂"]="", ["▅"]="", ["▆"]="", ["＋"]="", ["‘"]="", ["’"]="", ["【"]="", ["】"]="", ["│"]="",

	--This is the replacement table. It serves to deobfuscate words by replacing letters with their English "equivalents".
	["а"]="a", ["à"]="a", ["á"]="a", ["ä"]="a", ["â"]="a", ["ã"]="a", ["å"]="a", -- First letter is Russian "\208\176". Convert > \97.
	["Ą"]="a", ["ą"]="a", ["Ā"]="a", ["ā"]="a", ["Ă"]="a", ["ă"]="a", -- Convert > \97. Note: Ą, Ā, Ă fail with strlower, include both.
	["с"]="c", ["ç"]="c", ["Ć"]="c", ["ć"]="c", ["Č"]="c", ["č"]="c", ["Ĉ"]="c", ["ĉ"]="c", ["Ċ"]="c", ["ċ"]="c", --First letter is Russian "\209\129". Convert > \99. Note: Ć, Č, Ĉ, Ċ fail with strlower, include both.
	["Ď"]="d", ["ď"]="d", ["Đ"]="d", ["đ"]="d", --Convert > \100. Note: Ď, Đ fail with strlower, include both.
	["е"]="e", ["è"]="e", ["é"]="e", ["ë"]="e", ["ё"]="e", ["ê"]="e", --First letter is Russian "\208\181". Convert > \101. 
	["Ę"]="e", ["ę"]="e", ["Ė"]="e", ["ė"]="e", ["Ě"]="e", ["ě"]="e", ["Ē"]="e", ["ē"]="e", ["Έ"]="e", ["έ"]="e", ["Ĕ"]="e", ["ĕ"]="e", ["Ε"]="e", ["ε"]="e", --Note: Ę, Ė, Ě, Ē, Έ, Ĕ, Ε fail with strlower, include both.
	["Ğ"]="g", ["ğ"]="g", ["Ĝ"]="g", ["ĝ"]="g", ["Ģ"]="g", ["ģ"]="g", ["Ġ"]="g", ["ġ"]="g", -- Convert > \103. Note: Ğ, Ĝ, Ģ, Ġ fail with strlower, include both.
	["Ĥ"]="h", ["ĥ"]="h", -- Convert > \104. Note: Ĥ fail with strlower, include both.
	["ì"]="i", ["í"]="i", ["ï"]="i", ["î"]="i", ["İ"]="i", ["ı"]="i", -- Convert > \105.
	["Ϊ"]="i", ["ϊ"]="i", ["Ι"]="i", ["ι"]="i", ["Ί"]="i", ["ί"]="i", ["Ĭ"]="i", ["ĭ"]="i", ["Ї"]="i", ["ї"]="i", --Convert > \105. -- Note: Ϊ, Ι, Ί, Ĭ, Ї fail with strlower, include both.
	["Į"]="i", ["į"]="i", ["Ĩ"]="i", ["ĩ"]="i", ["Ī"]="i", ["ī"]="i", ["Ｉ"]="i", ["ｉ"]="i", --Convert > \105. -- Note: Į, Ĩ, Ī, Ｉ fail with strlower, include both.
	["Ĵ"]="j", ["ĵ"]="j", -- Convert > \106. -- Note: Ĵ fail with strlower, include both.
	["к"]="k", ["Ķ"]="k", ["ķ"]="k", -- First letter is Russian "\208\186". Convert > \107. -- Note: Ķ fail with strlower, include both.
	["Ł"]="l", ["ł"]="l", ["Ĺ"]="l", ["ĺ"]="l", ["Ľ"]="l", ["ľ"]="l", -- Convert > \107. -- Note: Ł, Ĺ, Ľ fail with strlower, include both.
	["Μ"]="m", ["м"]="m", -- First letter is capital Greek μ "\206\156". Convert > \109
	["η"]="n", ["ή"]="n", ["ñ"]="n", ["Ν"]="n", -- First letter is small Greek eta η "\206\183". Convert > \110. 
	["Ń"]="n", ["ń"]="n", ["Ņ"]="n", ["ņ"]="n", ["Ň"]="n", ["ň"]="n", ["Ŋ"]="n", ["ŋ"]="n", --Convert > \110. Note: Ń, Ņ, Ň, Ŋ fail with strlower, include both.
	["о"]="o", ["ò"]="o", ["ó"]="o", ["ö"]="o", ["ô"]="o", ["õ"]="o", ["ø"]="o", ["σ"]="o", --First letter is Russian "\208\190". Convert > \111.
	["Ō"]="o", ["ō"]="o", ["Ǿ"]="o", ["ǿ"]="o", ["Ő"]="o", ["ő"]="o", ["Θ"]="o", ["θ"]="o", ["Ŏ"]="o", ["ŏ"]="o", ["Ｏ"]="o", ["ｏ"]="o", --Note: Ō, Ǿ, Ő, Θ, Ŏ, Ｏ fail with strlower, include both.
	["р"]="p", ["þ"]="p", ["φ"]="p", ["Ρ"]="p", ["ρ"]="p", --First letter is Russian "\209\128". Convert > \112. --Note: Ρ fail with strlower, include both.
	["Ｑ"]="q", ["ｑ"]="q", --Note: Ｑ fail with strlower, include both.
	["г"]="r", ["я"]="r", ["Ř"]="r", ["ř"]="r", ["Ŕ"]="r", ["ŕ"]="r", ["Ŗ"]="r", ["ŗ"]="r", --Convert > \114. -- Note: Ř, Ŕ, Ŗ fail with strlower, include both.
	["Ş"]="s", ["ş"]="s", ["Š"]="s", ["š"]="s", ["Ś"]="s", ["ś"]="s", ["Ŝ"]="s", ["ŝ"]="s", ["Ѕ"]="s", ["ѕ"]="s", --Convert > \115. -- Note: Ş, Š, Ś, Ŝ, Ѕ fail with strlower, include both.
	["т"]="t", ["Ŧ"]="t", ["ŧ"]="t", ["Τ"]="t", ["τ"]="t", ["Ţ"]="t", ["ţ"]="t", ["Ť"]="t", ["ť"]="t", --Convert > \116. -- Note: Ŧ, Τ, Ţ, Ť fail with strlower, include both.
	["ù"]="u", ["ú"]="u", ["ü"]="u", ["û"]="u", --Convert > \117.
	["Ų"]="u", ["ų"]="u", ["Ŭ"]="u", ["ŭ"]="u", ["Ů"]="u", ["ů"]="u", ["Ű"]="u", ["ű"]="u", ["Ū"]="u", ["ū"]="u", --Convert > \117. -- Note: Ų, Ŭ, Ů, Ű, Ū fail with strlower, include both.
	["ω"]="w", ["ώ"]="w", ["Ẃ"]="w", ["ẃ"]="w", ["Ẁ"]="w", ["ẁ"]="w", ["Ŵ"]="w", ["ŵ"]="w", ["Ẅ"]="w", ["ẅ"]="w", ["Ｗ"]="w", ["ｗ"]="w", -- First letter is small Greek omega Ώ "\207\142". Convert > \119. -- Note: Ẃ, Ẁ, Ŵ, Ẅ, Ｗ fail with strlower, include both.
	["у"]="y", ["ý"]="y", ["Ÿ"]="y", ["ÿ"]="y", -- First letter is Russian "\209\131". Convert > \121. -- Note: Ÿ fail with strlower, include both.
	["０"]="0", ["１"]="1", ["２"]="2", ["３"]="3", ["４"]="4", ["５"]="5", ["６"]="6", ["７"]="7", ["８"]="8", ["９"]="9",
	["•"]=".", ["·"]=".", ["，"]=",", ["º"]="o", ["®"]="r", ["○"]="o", ["†"]="t",
}

--[[ Chat Scanning ]]--
local Ambiguate, BNGetGameAccountInfoByGUID, gsub, lower, next, type, tremove = Ambiguate, BNGetGameAccountInfoByGUID, gsub, string.lower, next, type, tremove
local IsFriend, IsGuildMember, UnitInRaid, UnitInParty, CanComplainChat, SetCVar = C_FriendList.IsFriend, IsGuildMember, UnitInRaid, UnitInParty, CanComplainChat, SetCVar
local CanReportPlayer, OpenReportPlayerDialog, PlayerLocation = function() end, function() end, PlayerLocation
local spamCollector, spamLogger, prevShow, enableBubble = {}, {}, 0, false
local blockedLineId, et, chatLines, chatPlayers = 0, 7, {}, {}
local btn, reportFrame
local function IsFriendly(name, flag, _, guid)
	if not guid then return true end -- LocalDefense automated prints
	if not guid:find("^Player") then -- Bad addons
		local msg = "BadBoy: Unexpected GUID requested by an addon: ".. guid
		print(msg)
		geterrorhandler()(msg)
		return true
	end
	local _, characterName = BNGetGameAccountInfoByGUID(guid)
	if characterName or IsGuildMember(guid) or IsFriend(guid) or UnitInRaid(name) or UnitInParty(name) or flag == "GM" or flag == "DEV" then
		return true
	end
end
local function Cleanse(msg)
	msg = gsub(msg, "|c[^%[]+%[([^%]]+)%]|h|r", "%1") -- Speed up processing messages with links by removing them
	msg = lower(msg) --Lower all text, remove capitals
	for k,v in next, repTbl do
		msg = gsub(msg, k, v)
	end
	return msg
end
local eventFunc = function(_, event, msg, player, _, _, _, flag, channelId, channelNum, _, _, lineId, guid)
	-- Re-enable chat bubbles if they were disabled in the previous event.
	if enableBubble then
		enableBubble = false
		SetCVar("chatBubbles", 1)
	end

	blockedLineId = 0
	if event == "CHAT_MSG_CHANNEL" and (channelId == 0 or type(channelId) ~= "number") then return end --Only scan official custom channels (gen/trade)

	local trimmedPlayer = Ambiguate(player, "none")
	if IsFriendly(trimmedPlayer, flag, nil, guid) then return end

	local debug = msg --Save original message format
	msg = Cleanse(msg)

	--20 line text buffer, this checks the current line, and blocks it if it's the same as one of the previous 20
	if event == "CHAT_MSG_CHANNEL" then
		local cleanestMsg = gsub(msg, "[@,./\\=]", "") -- Anything purposely not removed by Cleanse()
		for i=1, #chatLines do
			if chatLines[i] == cleanestMsg and chatPlayers[i] == guid then --If message same as one in previous 20 and from the same person...
				blockedLineId = lineId
				-- Reduce the chances of a spam report expiring (line id is too old) by refreshing it
				if spamCollector[guid] and S.is(msg) then
					local loc = PlayerLocation:CreateFromChatLineID(lineId)
					spamCollector[guid] = loc
					if BADBOY_OPTIONS.tipSpam then
						spamLogger[guid] = debug
					end
				end
				--
				return
			end
			if i == 20 then tremove(chatLines, 1) tremove(chatPlayers, 1) end --Don't let the DB grow larger than 20
		end
		chatLines[#chatLines+1] = cleanestMsg
		chatPlayers[#chatPlayers+1] = guid
	end
	--End text buffer

	if S.is(msg) then
		if event == "CHAT_MSG_SAY" or event == "CHAT_MSG_YELL" then
			-- Awful way of disabling chat bubbles when spam is detected.
			-- Chat bubbles are processed internally by the game client AFTER all the addon event handlers are fired.
			if GetCVarBool("chatBubbles") then
				enableBubble = true
				SetCVar("chatBubbles", 0)
			end
		end
		if not BADBOY_OPTIONS.freqButton then
			for i = 1, #S[et] do
				if strfind(msg, S[et][i]) then
					blockedLineId = lineId
					return
				end
			end
		end
		if BadBoyLog then
			BadBoyLog("BadBoy", event, trimmedPlayer, debug)
		end
		if not BADBOY_BLACKLIST[guid] and not IsEncounterInProgress() then
			local loc = PlayerLocation:CreateFromChatLineID(lineId)
			spamCollector[guid] = loc
			if BADBOY_OPTIONS.tipSpam then
				spamLogger[guid] = debug
				if btn:IsShown() and reportFrame:IsMouseOver() then
					GameTooltip_Hide()
					reportFrame:GetScript("OnEnter")(reportFrame) -- Add more spam to tooltip if shown
				end
			end

			local t = GetTime()
			if t-prevShow > (BADBOY_OPTIONS.freqBtn and 30 or 90) then
				if prevShow == 0 then
					prevShow = t+25
					-- Delay the first one to grab more spam on really bad realms
					C_Timer.After(25, function() btn:Show() end)
				else
					prevShow = t
					btn:Show()
				end
			end
		end

		blockedLineId = lineId
		return
	elseif next(spamCollector) then
		local t = GetTime()
		if t-prevShow > (BADBOY_OPTIONS.freqBtn and 30 or 90) then
			prevShow = t
			btn:Show()
		end
	end
end
local filterFunc = function(_, _, _, _, _, _, _, _, _, _, _, _, lineId)
	if blockedLineId == lineId then
		return true
	end
end

do
	btn = CreateFrame("Frame", nil, ChatFrame1)
	btn:SetWidth(50)
	btn:SetHeight(50)
	btn:SetPoint("BOTTOMRIGHT", 18, -20)
	btn:SetFrameStrata("DIALOG")
	local tx = btn:CreateTexture()
	tx:SetAllPoints(btn)
	tx:SetMask("Interface\\CharacterFrame\\TempPortraitAlphaMask")
	tx:SetTexture(132360) -- Interface/Icons/Ability_Warrior_ShieldMastery
	local animGroup = btn:CreateAnimationGroup()
	animGroup:SetLooping("REPEAT")
	local scale = animGroup:CreateAnimation("Scale")
	scale:SetOrder(1)
	scale:SetFromScale(0.25,0.25)
	scale:SetToScale(1,1)
	scale:SetDuration(0.4)
	local scale2 = animGroup:CreateAnimation("Scale")
	scale2:SetOrder(2)
	scale2:SetFromScale(1,1)
	scale2:SetToScale(0.25,0.25)
	scale2:SetDuration(0.4)
	scale2:SetEndDelay(8)
	animGroup:Play()
	btn:Hide()

	reportFrame = CreateFrame("Button", nil, btn)
	reportFrame:SetAllPoints(ChatFrame1)
	reportFrame:SetFrameStrata("DIALOG")
	local ticker = nil
	local tickerFunc = function()
		local canReport = false
		for k, v in next, spamCollector do
			if CanReportPlayer(v) then
				canReport = true
			else
				spamCollector[k] = nil
				spamLogger[k] = nil
			end
		end
		if not canReport then
			btn:Hide()
		end
	end
	btn:SetScript("OnShow", function()
		if ticker then ticker:Cancel() end
		ticker = C_Timer.NewTicker(5, tickerFunc)
		tickerFunc()
		-- Don't animate if the feature is disabled
		if animGroup:IsPlaying() and BADBOY_OPTIONS.noAnim then
			btn:SetWidth(12)
			btn:SetHeight(12)
			animGroup:Stop()
			btn:ClearAllPoints()
			btn:SetPoint("BOTTOMRIGHT", 0, -5)
		elseif not animGroup:IsPlaying() and not BADBOY_OPTIONS.noAnim then
			btn:SetWidth(46)
			btn:SetHeight(46)
			animGroup:Play()
			btn:ClearAllPoints()
			btn:SetPoint("BOTTOMRIGHT", 18, -20)
		end
	end)
	btn:SetScript("OnHide", function()
		if ticker then
			ticker:Cancel()
			ticker = nil
		end
	end)
	reportFrame:SetScript("OnClick", function(self, btn)
		if IsAltKeyDown() then -- Dismiss
			prevShow = GetTime() -- Refresh throttle so we don't risk showing again straight after reporting
			self:GetParent():Hide()
			spamCollector, spamLogger = {}, {}
		else -- Report
			prevShow = GetTime() -- Refresh throttle so we don't risk showing again straight after reporting
			self:GetParent():Hide()

			local systemMsg = {GetFramesRegisteredForEvent("REPORT_PLAYER_RESULT")} -- Don't show the "Complaint Registered" message
			local calendarError = {GetFramesRegisteredForEvent("CALENDAR_UPDATE_ERROR")} -- Remove calendar error popup (Blizz bug)
			for i = 1, #systemMsg do
				systemMsg[i]:UnregisterEvent("REPORT_PLAYER_RESULT")
			end
			for i = 1, #calendarError do
				calendarError[i]:UnregisterEvent("CALENDAR_UPDATE_ERROR")
			end

			for k, v in next, spamCollector do
				if CanReportPlayer(v) then
					BADBOY_BLACKLIST[k] = true
					if OpenReportPlayerDialog then
						OpenReportPlayerDialog("spam", "Spammer blocked by BadBoy", v)
					end
				end
				spamCollector[k] = nil
				spamLogger[k] = nil
				if BADBOY_BLACKLIST[k] then
					break -- Only open 1 dialog
				end
			end

			for i = 1, #systemMsg do
				-- Compensate for people taking a while to click accept
				C_Timer.After(5, function() systemMsg[i]:RegisterEvent("REPORT_PLAYER_RESULT") end)
			end
			for i = 1, #calendarError do
				-- There's a delay before the event fires
				C_Timer.After(5, function() calendarError[i]:RegisterEvent("CALENDAR_UPDATE_ERROR") end)
			end
		end
	end)
	reportFrame:SetScript("OnEnter", function(self)
		GameTooltip:SetOwner(self, "ANCHOR_CURSOR")
		GameTooltip:AddLine(S.spamBlocked, 1, 1, 1)
		GameTooltip:AddLine(S.clickToReport, 1, 1, 1)
		if next(spamLogger) then
			GameTooltip:AddLine(" ", 0.5, 0.5, 1)
			for k, v in next, spamLogger do
				GameTooltip:AddLine(v, 0.2, 1, 0)
			end
		end
		GameTooltip:Show()
	end)
	reportFrame:SetScript("OnLeave", GameTooltip_Hide)
end

--[[ Add Filters ]]--
do
	local f = CreateFrame("Frame")
	f:SetScript("OnEvent", eventFunc)
	local tbl = {
		"CHAT_MSG_CHANNEL",
		"CHAT_MSG_YELL",
		"CHAT_MSG_SAY",
		"CHAT_MSG_WHISPER",
		"CHAT_MSG_EMOTE",
		"CHAT_MSG_DND",
		"CHAT_MSG_AFK",
	}
	for i = 1, #tbl do
		local event = tbl[i]
		local frames = {GetFramesRegisteredForEvent(event)}
		for i = 1, #frames do
			local frame = frames[i]
			frame:UnregisterEvent(event)
		end
		f:RegisterEvent(event)
		ChatFrame_AddMessageEventFilter(event, filterFunc)
		for i = 1, #frames do
			local frame = frames[i]
			frame:RegisterEvent(event)
		end
	end
end

--[[ Blacklist ]]--
do
	local f = CreateFrame("Frame")
	f:RegisterEvent("ADDON_LOADED")
	f:RegisterEvent("PLAYER_LOGIN")
	f:SetScript("OnEvent", function(frame, event, addon)
		if addon == "BadBoy" then
			if type(BADBOY_OPTIONS) ~= "table" then BADBOY_OPTIONS = {} end
			if type(BADBOY_BLACKLIST) ~= "table" then BADBOY_BLACKLIST = {} end
			frame:UnregisterEvent(event)
		elseif event == "PLAYER_LOGIN" then
			-- Blacklist DB setup, needed since Blizz nerfed ReportPlayer so hard the block sometimes only lasts a few minutes.
			local dateTbl = date("*t")
			local day = dateTbl.day
			if BADBOY_BLACKLIST.dayFromCal ~= day then
				BADBOY_BLACKLIST = {dayFromCal = day} -- Can't use ADDON_LOADED as date function isn't always ready on very first login.
			end
			SetCVar("spamFilter", 1)
			frame:UnregisterEvent(event)
			BADBOY_OPTIONS.tmp = nil
			BADBOY_OPTIONS.tmpm = nil
			BADBOY_OPTIONS.tmpl = nil
			BADBOY_OPTIONS.freqButton = nil

			-- Chat bubble restore
			frame:SetScript("OnEvent", function()
				if enableBubble then
					enableBubble = false
					SetCVar("chatBubbles", 1)
				end
			end)
			-- Hopefully we never end up in a situation where we've permanently disabled chat bubbles for the user.
			frame:RegisterEvent("PLAYER_LOGOUT")
			frame:RegisterEvent("CHAT_MSG_MONSTER_SAY")
			frame:RegisterEvent("CHAT_MSG_MONSTER_YELL")
		end
	end)
end

_G.BadBoyIsFriendly = IsFriendly
_G.BadBoyCleanse = Cleanse
